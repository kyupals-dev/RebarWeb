install dependencies

!pip install -U torch torchvision

!pip install git+https://github.com/facebookresearch/detectron2.git

import cv2
import torch
from detectron2.engine import DefaultPredictor
from detectron2.config import get_cfg
from detectron2.utils.visualizer import Visualizer
from detectron2.data import MetadataCatalog
import matplotlib.pyplot as plt

from detectron2 import model_zoo

cfg = get_cfg()
cfg.merge_from_file(model_zoo.get_config_file("COCO-InstanceSegmentation/mask_rcnn_R_50_FPN_3x.yaml"))
cfg.MODEL.WEIGHTS = "model_final directory"
cfg.MODEL.ROI_HEADS.SCORE_THRESH_TEST = 0.5
cfg.MODEL.ROI_HEADS.NUM_CLASSES = 3 #back_horizontal', 'front_horizontal', 'front_vertical'
cfg.MODEL.DEVICE = "cuda" if torch.cuda.is_available() else "cpu"


# Register class names
my_metadata = MetadataCatalog.get("my_dataset")
my_metadata.set(thing_classes=['back_horizontal', 'front_horizontal', 'front_vertical'])

predictor = DefaultPredictor(cfg)
